<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Gi·ªè h√†ng</title>
<style>
  body { font-family: Arial, sans-serif; background: #f4f6f9; margin: 0; padding: 20px; }
  h1 { text-align: center; color: #673ab7; }
  .cart-container { max-width: 900px; margin: 20px auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
  table { width: 100%; border-collapse: collapse; }
  th, td { padding: 10px; text-align: center; border-bottom: 1px solid #ddd; }
  img { width: 60px; height: 80px; object-fit: cover; }
  .remove-btn { color: red; cursor: pointer; font-weight: bold; }
  .total { text-align: right; font-size: 18px; font-weight: bold; margin-top: 15px; }
  .checkout-btn { background: #4caf50; color: white; padding: 12px 20px; font-size: 16px; border: none; border-radius: 6px; cursor: pointer; margin-top: 20px; display: block; width: 100%; }
  .checkout-btn:hover { background: #43a047; }
  .back-btn { display: block; margin-top: 15px; text-align: center; color: #673ab7; font-weight: bold; text-decoration: none; }
</style>
</head>
<body>
  <h1>üõí Gi·ªè h√†ng</h1>
  <div class="cart-container">
    <table id="cartTable">
      <thead>
        <tr>
          <th>·∫¢nh</th>
          <th>S·∫£n ph·∫©m</th>
          <th>Gi√°</th>
          <th>S·ªë l∆∞·ª£ng</th>
          <th>X√≥a</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <p class="total" id="totalPrice">T·ªïng: 0 VNƒê</p>
    <button class="checkout-btn" id="checkoutBtn">Thanh to√°n</button>
    <a href="../index.html" class="back-btn">‚¨Ö Ti·∫øp t·ª•c mua s·∫Øm</a>
  </div>

<script>
  const tbody = document.querySelector("#cartTable tbody");
  const totalPriceEl = document.getElementById("totalPrice");

  function loadCart() {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    tbody.innerHTML = "";
    let total = 0;

    if (cart.length === 0) {
      tbody.innerHTML = `<tr><td colspan="5">Gi·ªè h√†ng tr·ªëng</td></tr>`;
      document.getElementById("checkoutBtn").disabled = true;
      return;
    }

    cart.forEach((item, index) => {
      const subtotal = item.price * item.quantity;
      total += subtotal;
      const row = `
        <tr>
          <td><img src="${item.image}" alt="${item.title}"></td>
          <td>${item.title}</td>
          <td>${item.price.toLocaleString()} VNƒê</td>
          <td>
            <input type="number" min="1" value="${item.quantity}" data-index="${index}" class="qty-input" style="width:50px;">
          </td>
          <td><span class="remove-btn" data-index="${index}">X</span></td>
        </tr>
      `;
      tbody.innerHTML += row;
    });

    totalPriceEl.textContent = `T·ªïng: ${total.toLocaleString()} VNƒê`;

    document.querySelectorAll(".remove-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        removeItem(btn.dataset.index);
      });
    });

    document.querySelectorAll(".qty-input").forEach(input => {
      input.addEventListener("change", () => {
        updateQuantity(input.dataset.index, parseInt(input.value));
      });
    });
  }

  function removeItem(index) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    cart.splice(index, 1);
    localStorage.setItem("cart", JSON.stringify(cart));
    loadCart();
  }

  function updateQuantity(index, qty) {
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    if (qty > 0) {
      cart[index].quantity = qty;
      localStorage.setItem("cart", JSON.stringify(cart));
      loadCart();
    }
  }

  document.getElementById("checkoutBtn").addEventListener("click", () => {
    alert("Thanh to√°n th√†nh c√¥ng! (Gi·∫£ l·∫≠p)");
    localStorage.removeItem("cart");
    loadCart();
  });

  loadCart();
</script>
</body>
</html>
